

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8">
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  
  <title>Developer Guide &mdash; NeuroCAAS Website 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="_static/pygments.css" type="text/css" />

  
  
  
  

  
  <!--[if lt IE 9]>
    <script src="_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="./" src="_static/documentation_options.js"></script>
        <script src="_static/jquery.js"></script>
        <script src="_static/underscore.js"></script>
        <script src="_static/doctools.js"></script>
        <script src="_static/language_data.js"></script>
    
    <script type="text/javascript" src="_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="genindex.html" />
    <link rel="search" title="Search" href="search.html" />
    <link rel="prev" title="Accounts and Permissions" href="permissions.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="index.html" class="icon icon-home" alt="Documentation Home"> NeuroCAAS Website
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Contents:</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="apps/index.html">Django Apps</a></li>
<li class="toctree-l1"><a class="reference internal" href="permissions.html">Accounts and Permissions</a></li>
<li class="toctree-l1 current"><a class="current reference internal" href="#">Developer Guide</a><ul>
<li class="toctree-l2"><a class="reference internal" href="#project-structure">1. Project Structure</a></li>
<li class="toctree-l2"><a class="reference internal" href="#deployment-on-ubuntu-server">2. Deployment on Ubuntu Server</a></li>
<li class="toctree-l2"><a class="reference internal" href="#database-information">3. Database Information</a></li>
<li class="toctree-l2"><a class="reference internal" href="#aws-s3-file-uploading">4. AWS S3 File Uploading</a></li>
<li class="toctree-l2"><a class="reference internal" href="#automated-iam-management">5. Automated IAM Management</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="index.html">NeuroCAAS Website</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="index.html" class="icon icon-home"></a> &raquo;</li>
        
      <li>Developer Guide</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
            
            <a href="_sources/devguide.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="section" id="developer-guide">
<h1>Developer Guide<a class="headerlink" href="#developer-guide" title="Permalink to this headline">¶</a></h1>
<p>This section contains guidance for developing NeuroCAAS</p>
<p>To contribute to NeuroCAAS, please contact us at <a class="reference external" href="mailto:neurocaas&#37;&#52;&#48;gmail&#46;com">neurocaas<span>&#64;</span>gmail<span>&#46;</span>com</a></p>
<div class="section" id="project-structure">
<h2>1. Project Structure<a class="headerlink" href="#project-structure" title="Permalink to this headline">¶</a></h2>
<p>This project utilizes two django apps, <a class="reference internal" href="apps/account/index.html#account"><span class="std std-ref">Account</span></a> and <a class="reference internal" href="apps/main/index.html#main"><span class="std std-ref">Main</span></a>.
The <a class="reference internal" href="apps/account/index.html#account"><span class="std std-ref">Account</span></a> app handles user management,
and the <a class="reference internal" href="apps/main/index.html#main"><span class="std std-ref">Main</span></a> app has core functions to process data.</p>
</div>
<div class="section" id="deployment-on-ubuntu-server">
<h2>2. Deployment on Ubuntu Server<a class="headerlink" href="#deployment-on-ubuntu-server" title="Permalink to this headline">¶</a></h2>
<p>Refer to <a class="reference external" href="https://www.digitalocean.com/community/tutorials/how-to-set-up-django-with-postgres-nginx-and-gunicorn-on-ubuntu-18-04">this link</a> for additional assistance.</p>
<p><strong>Install essential packages:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo apt update
$ sudo apt install python3-pip python3-dev libpq-dev postgresql postgresql-contrib nginx curl
</pre></div>
</div>
<p><strong>Install virtualenv:</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo pip3 install virtualenv
$ cd /home/ubuntu/ncap
$ virtualenv venv
$ source venv/bin/activate
$ pip install –r requirements.txt
$ sudo ufw allow 8000
$ deactivate
</pre></div>
</div>
<p><strong>Clone the repo</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ git clone https://github.com/jjhbriggs/neurocaas_frontend ncap
</pre></div>
</div>
<p><strong>Install dependencies</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ cd ncap
$ virtualenv venv
$ source  venv/bin/activate
(venv) $ pip install -r requirements.txt
</pre></div>
</div>
<p><strong>Create systemd Socket and Service Files for Gunicorn</strong></p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo nano /etc/systemd/system/gunicorn. Service
</pre></div>
</div>
<p>Add the following content and save:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="p">[</span><span class="n">Unit</span><span class="p">]</span>
<span class="n">Description</span><span class="o">=</span><span class="n">gunicorn</span> <span class="n">daemon</span>
<span class="n">Requires</span><span class="o">=</span><span class="n">gunicorn</span><span class="o">.</span><span class="n">socket</span>
<span class="n">After</span><span class="o">=</span><span class="n">network</span><span class="o">.</span><span class="n">target</span>

<span class="p">[</span><span class="n">Service</span><span class="p">]</span>
<span class="n">User</span><span class="o">=</span><span class="n">ubuntu</span>
<span class="n">Group</span><span class="o">=</span><span class="n">www</span><span class="o">-</span><span class="n">data</span>
<span class="n">WorkingDirectory</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">ncap</span>
<span class="n">ExecStart</span><span class="o">=/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">ncap</span><span class="o">/</span><span class="n">venv</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">gunicorn</span> \
                  <span class="o">--</span><span class="n">access</span><span class="o">-</span><span class="n">logfile</span> <span class="o">-</span> \
                  <span class="o">--</span><span class="n">workers</span> <span class="mi">3</span> \
                  <span class="o">--</span><span class="n">bind</span> <span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">gunicorn</span><span class="o">.</span><span class="n">sock</span> \
                  <span class="n">ncap</span><span class="o">.</span><span class="n">wsgi</span><span class="p">:</span><span class="n">application</span>
<span class="p">[</span><span class="n">Install</span><span class="p">]</span>
<span class="n">WantedBy</span><span class="o">=</span><span class="n">multi</span><span class="o">-</span><span class="n">user</span><span class="o">.</span><span class="n">target</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo systemctl daemon-reload
$ sudo systemctl restart gunicorn
</pre></div>
</div>
<p><strong>Configure Nginx to Proxy Pass to Gunicorn</strong></p>
<p>Install  Nginx</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo apt install nginx
</pre></div>
</div>
<p>Configure Nginx</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo nano /etc/nginx/sites-available/ncap
</pre></div>
</div>
<p>Add following content and save:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">server</span> <span class="p">{</span>
        <span class="n">listen</span> <span class="mi">80</span><span class="p">;</span>
        <span class="n">server_name</span> <span class="n">www</span><span class="o">.</span><span class="n">neurocaas</span><span class="o">.</span><span class="n">com</span> <span class="n">neurocaas</span><span class="o">.</span><span class="n">com</span> <span class="n">neurocaas</span><span class="o">.</span><span class="n">org</span> <span class="n">www</span><span class="o">.</span><span class="n">neurocaas</span><span class="o">.</span><span class="n">org</span><span class="p">;</span>
        <span class="n">location</span> <span class="o">=</span> <span class="o">/</span><span class="n">favicon</span><span class="o">.</span><span class="n">ico</span> <span class="p">{</span> <span class="n">access_log</span> <span class="n">off</span><span class="p">;</span> <span class="n">log_not_found</span> <span class="n">off</span><span class="p">;</span> <span class="p">}</span>
        <span class="n">location</span> <span class="o">/</span><span class="n">static</span><span class="o">/</span> <span class="p">{</span>
                        <span class="n">root</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">ncap</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">location</span> <span class="o">/</span><span class="n">docs</span><span class="o">/</span> <span class="p">{</span>
                        <span class="n">alias</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">ncap</span><span class="o">/</span><span class="n">docs</span><span class="o">/</span><span class="n">build</span><span class="o">/</span><span class="n">html</span><span class="o">/</span><span class="p">;</span>
                        <span class="n">index</span>  <span class="n">index</span><span class="o">.</span><span class="n">html</span> <span class="n">index</span><span class="o">.</span><span class="n">htm</span><span class="p">;</span>
        <span class="p">}</span>
        <span class="n">location</span> <span class="o">/</span> <span class="p">{</span>
                        <span class="n">include</span> <span class="n">proxy_params</span><span class="p">;</span>
                        <span class="n">proxy_pass</span> <span class="n">http</span><span class="p">:</span><span class="o">//</span><span class="n">unix</span><span class="p">:</span><span class="o">/</span><span class="n">run</span><span class="o">/</span><span class="n">gunicorn</span><span class="o">.</span><span class="n">sock</span><span class="p">;</span>
         <span class="p">}</span>
<span class="p">}</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo ln -s /etc/nginx/sites-available/ncap /etc/nginx/sites-enabled
$ sudo nginx –t
$ sudo systemctl restart nginx
$ sudo ufw delete allow 8000
$ sudo ufw allow &#39;Nginx Full&#39;
</pre></div>
</div>
<p><strong>Environment Variables</strong></p>
<p>A set of valid AWS keys is needed to run tests properly. These should be set in .bash_profile.</p>
<p>Add these lines to your .bash_profile in the home directory (with your keys in place of the placeholders).
Travis CI has a similar set of environement variables in its project settings which are used for testing, however local testing requires that the developer source bash_profile by running:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">source</span> <span class="o">.</span><span class="n">bash_profile</span>
</pre></div>
</div>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">export</span> <span class="n">AWS_ACCESS_KEY</span><span class="o">=&lt;</span><span class="n">placeholder</span><span class="o">&gt;</span>
<span class="n">export</span> <span class="n">AWS_SECRET_ACCESS_KEY</span><span class="o">=&lt;</span><span class="n">placeholder</span><span class="o">&gt;</span>
</pre></div>
</div>
<p><strong>Cron Job</strong></p>
<p>There is a python script located “/home/ubuntu/ncap/cron.py”.
It is running daily, removing old files in “/home/ubuntu/ncap/static/downloads” folder.</p>
<p>There is an additional python script called db_backup.py that backups the database to an s3 bucket daily.</p>
<p>Run the following command to edit crontab config (with &lt;placeholder&gt;s replaced with the AWS keys used to access your s3 bucket.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ crontab –e
</pre></div>
</div>
<p>Add these line and save:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">AWS_ACCESS_KEY</span><span class="o">=&lt;</span><span class="n">placeholder</span><span class="o">&gt;</span>
<span class="n">AWS_SECRET_ACCESS_KEY</span><span class="o">=&lt;</span><span class="n">placeholder</span><span class="o">&gt;</span>
<span class="mi">5</span> <span class="mi">4</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python3</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">ncap</span><span class="o">/</span><span class="n">cron</span><span class="o">.</span><span class="n">py</span> <span class="o">&gt;&gt;</span> <span class="o">~/</span><span class="n">cron</span><span class="o">.</span><span class="n">log</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
<span class="mi">0</span> <span class="mi">0</span> <span class="o">*</span> <span class="o">*</span> <span class="o">*</span> <span class="o">/</span><span class="n">usr</span><span class="o">/</span><span class="nb">bin</span><span class="o">/</span><span class="n">python3</span> <span class="o">/</span><span class="n">home</span><span class="o">/</span><span class="n">ubuntu</span><span class="o">/</span><span class="n">ncap</span><span class="o">/</span><span class="n">db_backup</span><span class="o">.</span><span class="n">py</span> <span class="o">&gt;&gt;</span> <span class="o">~/</span><span class="n">cron_db</span><span class="o">.</span><span class="n">log</span> <span class="mi">2</span><span class="o">&gt;&amp;</span><span class="mi">1</span>
</pre></div>
</div>
<p>Start Cron job</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>$ sudo service cron start
</pre></div>
</div>
</div>
<div class="section" id="database-information">
<h2>3. Database Information<a class="headerlink" href="#database-information" title="Permalink to this headline">¶</a></h2>
<p>Currently the database used in NeuroCAAS is sqlite. The DB configuration is stored in ncap/settings.py.</p>
<p>To migrate the database, run the following in the command line:</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">python3</span> <span class="n">manage</span><span class="o">.</span><span class="n">py</span> <span class="n">migrate</span>
</pre></div>
</div>
<p><strong>Database Diagram:</strong></p>
<img alt="_images/dbdiagram.png" src="_images/dbdiagram.png" />
<p>Additionally, Django stores a hashed password for every user. See the Django documentation on this for more information: <a class="reference external" href="https://docs.djangoproject.com/en/3.0/topics/auth/passwords/">https://docs.djangoproject.com/en/3.0/topics/auth/passwords/</a></p>
</div>
<div class="section" id="aws-s3-file-uploading">
<h2>4. AWS S3 File Uploading<a class="headerlink" href="#aws-s3-file-uploading" title="Permalink to this headline">¶</a></h2>
<p>File uploading is done using a multipart upload based on the aws sdk javascript plugin (<a class="reference external" href="https://sdk.amazonaws.com/js/aws-sdk-2.617.0.min.js">https://sdk.amazonaws.com/js/aws-sdk-2.617.0.min.js</a>).
All functions needed to perform uploading are stored inside a js file named “file_upload.js” inside the “static/js/fileupload” folder.</p>
<p>Multiple large files can be uploaded via this drag and drop box.
To upload file to the s3 bucket, we need to add following permission on s3 bucket.</p>
<p>This allows users to upload files directly through a web browser.</p>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>&lt;?xml version=&quot;1.0&quot; encoding=&quot;UTF-8&quot;?&gt;
&lt;CORSConfiguration xmlns=&quot;http://s3.amazonaws.com/doc/2006-03-01/&quot;&gt;
&lt;CORSRule&gt;
    &lt;AllowedOrigin&gt;*&lt;/AllowedOrigin&gt;
    &lt;AllowedMethod&gt;GET&lt;/AllowedMethod&gt;
    &lt;AllowedMethod&gt;PUT&lt;/AllowedMethod&gt;
    &lt;AllowedMethod&gt;POST&lt;/AllowedMethod&gt;
    &lt;AllowedMethod&gt;DELETE&lt;/AllowedMethod&gt;
    &lt;MaxAgeSeconds&gt;3000&lt;/MaxAgeSeconds&gt;
    &lt;ExposeHeader&gt;ETag&lt;/ExposeHeader&gt;
    &lt;AllowedHeader&gt;*&lt;/AllowedHeader&gt;
&lt;/CORSRule&gt;
&lt;/CORSConfiguration&gt;
</pre></div>
</div>
<img alt="_images/s3pic.png" src="_images/s3pic.png" />
</div>
<div class="section" id="automated-iam-management">
<h2>5. Automated IAM Management<a class="headerlink" href="#automated-iam-management" title="Permalink to this headline">¶</a></h2>
<p><strong>Actions it can perform:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Automatically add an IAM to a new analysis group (registers with django db and creates new cloudformation resources)</p></li>
<li><p>Automatically add an IAM to an existing analysis group (registers with django db and adds to existing cloudformation resources)</p></li>
<li><p>Delete an IAM (removes it from django db and cloudformation resources)</p></li>
</ol>
</div></blockquote>
<p><strong>Actions it can’t perform:</strong></p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Automatically add an IAM to any user which was created before these tools were created (as it won’t have the proper supporting variables setup)</p></li>
<li><p>Automatically add an IAM to any group which was created without this automation tool (as the backend cloudformation stacks will be named incorrectly)</p></li>
<li><p>Remove an IAM which was created before these tools were created</p></li>
<li><p>Remove an entire Ana Group. (E.x. Even if all members of a group are removed, the group will remain as well as its cloudformation resources. Removing these must be done manually</p></li>
<li><p>Additionally, if a user that is attached to an IAM is removed, the iam will not be removed with it, instead it will be associated to no user. <em>Remove the IAM before removing the user</em>.</p></li>
</ol>
</div></blockquote>
<p><strong>In short, use the tool only on new groups, iams, and users. Groups/iams/users made prior to the tool can be edited manually to work with the tool, but it will return errors when operating on anything old until this migration is performed.</strong></p>
<p>Step 1: Go to the user panel in the admin dashboard</p>
<img alt="_images/ua1.jpg" src="_images/ua1.jpg" />
<p>Step 2: Select one or more users to give or remove an iam</p>
<img alt="_images/ua2.jpg" src="_images/ua2.jpg" />
<p>Note the variables at the top, specifically <em>Has IAM attached</em>, which will help the user know if their operation was successful, and an IAM was created for that user.  This is a constantly updated function, so no page reload should be necessary to see updates to this variable.</p>
<p><em>Requested Group Name</em> is the group  which the user’s new IAM will be added to, and can be edited to add a user to a different group.</p>
<p><em>Requested group code</em> (optional), is only used in the user signup phase to automatically assign the requested group name based upon the group code (because the system prevents you just joining an existing group by name at signup).</p>
<p>The Use code variable is also only used at signup, and assists in determining whether to use the inputted name or code.</p>
<p><strong>Step 3: Select an action and press go.</strong></p>
<img alt="_images/ua3.jpg" src="_images/ua3.jpg" />
<p>A message (or an error) should now appear at the top looking something like this, notifying you of the started process, which will run in a subprocess on the ec2 instance.</p>
<img alt="_images/ua4.png" src="_images/ua4.png" />
<p>Wait a few minutes for your action to complete (more if you are adding/removing multiple IAMs at once), but if its clear that the process failed, then you can check the error logs in the ‘ncap/logs’ directory of the instance. While there are error and output logs for each action, they will both contain parts of the errors and outputs (because oddly some scripts log their output to std error).</p>
<p>Key Resources:</p>
<blockquote>
<div><ol class="arabic simple">
<li><p>Local cloned instance of the NeuroCAAS Project</p></li>
<li><p>The logs folder</p></li>
<li><p>The user credentials folder</p></li>
<li><p>The user addition Django management command</p></li>
<li><p>The modified deploy.sh script</p></li>
<li><p>The admin action for adding and deleting IAMs</p></li>
</ol>
</div></blockquote>
<p>To replicate this process on a new instance, all that needs to be done is as follows:</p>
<blockquote>
<div><blockquote>
<div><ol class="arabic simple">
<li><p>Create a folder named ‘logs’ in the project root folder (‘~/ncap’)</p></li>
<li><p>Create an appropriately named folder to store user credentials in, stored in the project root folder</p></li>
<li><p>Clone the main NeuroCAAS project onto the instance, stored in the project root folder</p></li>
<li><p>Navigate to neurocaas/ncap_iac/user_profiles/iac_utils and edit the deploy.sh so that the last 4 lines look like so:</p></li>
</ol>
</div></blockquote>
<div class="highlight-default notranslate"><div class="highlight"><pre><span></span>#These should be modified
cd $ncaprootdir/utils
python export_credentials.py $PIPEDIR &quot;../../../credentials_folder_from_step_1/&quot;
#These should be added
cd ~/ncap
python manage.py register_creds $PIPEDIR
</pre></div>
</div>
</div></blockquote>
<ol class="arabic" start="5">
<li><p>Navigate to the neurocaas folder and run:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">install</span> <span class="n">requirements</span><span class="o">.</span><span class="n">txt</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Dxecute aws configure and provide the proper details to setup the aws cli</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">aws</span> <span class="n">configure</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Install other dependencies</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">apt</span> <span class="n">install</span> <span class="n">jq</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">aws</span><span class="o">-</span><span class="n">sam</span><span class="o">-</span><span class="n">cli</span><span class="o">==</span><span class="mf">1.0</span><span class="o">.</span><span class="mi">0</span>
<span class="n">pip</span> <span class="n">install</span> <span class="n">docker</span><span class="o">==</span><span class="mf">4.2</span><span class="o">.</span><span class="mi">1</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Setup docker</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">start</span> <span class="n">docker</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">enable</span> <span class="n">docker</span>
<span class="n">sudo</span> <span class="n">systemctl</span> <span class="n">status</span> <span class="n">docker</span>
<span class="n">sudo</span> <span class="n">usermod</span> <span class="o">-</span><span class="n">a</span> <span class="o">-</span><span class="n">G</span> <span class="n">docker</span> <span class="n">ubuntu</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Restart the shell,  execute ‘docker ps’, and verify that your shell looks like this:</p>
<blockquote>
<div><div class="highlight-default notranslate"><div class="highlight"><pre><span></span><span class="n">CONTAINER</span> <span class="n">ID</span>        <span class="n">IMAGE</span>               <span class="n">COMMAND</span>             <span class="n">CREATED</span>             <span class="n">STATUS</span>              <span class="n">PORTS</span>               <span class="n">NAMES</span>
</pre></div>
</div>
</div></blockquote>
</li>
<li><p>Restart Nginx and Gunicorn</p></li>
</ol>
<dl class="simple">
<dt>General Process (IAM Addition):</dt><dd><ol class="arabic simple">
<li><p>An admin action to create a new IAM for a user is called</p></li>
<li><p>The admin action checks to ensure it is a valid request (ex. if the user already has an IAM it will be return an error)</p></li>
<li><p>The admin action creates the proper local resources for the creation of the cloudformation resources</p></li>
<li><p>The admin action calls the deploy.sh script which deploys the cloudformation resources (creating the IAM on the AWS side)</p></li>
<li><p>The deploy.sh script then calls a django management command which creates the IAM model locally and registers it with the django db</p></li>
<li><p>Outputs and Issues are stored to the logs folder</p></li>
</ol>
</dd>
<dt>General Process (IAM Removal):</dt><dd><ol class="arabic simple">
<li><p>An admin action to remove an IAM from a user is called</p></li>
<li><p>The admin action checks to ensure it is a valid request (ex. if the user doesn’t have an IAM it will be return an error)</p></li>
<li><p>The admin action removes the proper local resources for the creation of the cloudformation resources</p></li>
<li><p>The admin action calls the deploy.sh script which reddeploys the cloudformation resources (removing the IAM on the AWS side)</p></li>
<li><p>The admin action deletes the IAM from the django db</p></li>
<li><p>Outputs and Issues are stored to the logs folder</p></li>
</ol>
</dd>
</dl>
<p>More specific details can be found in the admin action and management command code.</p>
</div>
</div>


           </div>
           
          </div>
          <footer>
  
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
      
      
        <a href="permissions.html" class="btn btn-neutral float-left" title="Accounts and Permissions" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left"></span> Previous</a>
      
    </div>
  

  <hr/>

  <div role="contentinfo">
    <p>
        
        &copy; Copyright 2020, Jack Briggs

    </p>
  </div>
    
    
    
    Built with <a href="http://sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/rtfd/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>

        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>